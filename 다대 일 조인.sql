CREATE TABLE EMPLOYEE_TBL
(
    E_ID        CHAR(4)         NOT NULL  PRIMARY KEY, --荤盔酒捞叼
    E_NAME      VARCHAR2(30)    NOT NULL,              --荤盔捞抚
    PART_ID     CHAR(6)         NOT NULL               --家加何辑 肚绰 评
);

INSERT INTO EMPLOYEE_TBL VALUES('E001','全辨悼1','PT0002');  --牢荤何
INSERT INTO EMPLOYEE_TBL VALUES('E002','全辨悼2','PT0002');  --牢荤何
INSERT INTO EMPLOYEE_TBL VALUES('E003','全辨悼3','PT0002');  --牢荤何
INSERT INTO EMPLOYEE_TBL VALUES('E004','全辨悼4','PT0011');  --醚公何 1-1评
INSERT INTO EMPLOYEE_TBL VALUES('E005','全辨悼5','PT0011');  --醚公何 1-1评
INSERT INTO EMPLOYEE_TBL VALUES('E006','全辨悼6','PT0012');  --醚公何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E007','全辨悼7','PT0012');  --醚公何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E008','全辨悼8','PT0012');  --醚公何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E009','全辨悼9','PT0013');  --醚公何 2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E010','全辨悼10','PT0013'); --醚公何 2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E011','全辨悼11','PT0014'); --醚公何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E012','全辨悼12','PT0014'); --醚公何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E013','全辨悼13','PT0014'); --醚公何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E014','全辨悼14','PT0014'); --醚公何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E015','全辨悼15','PT0015'); --醚公何 3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E016','全辨悼16','PT0015'); --醚公何 3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E017','全辨悼17','PT0037'); --醚公何 3-2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E018','全辨悼18','PT0037'); --醚公何 3-2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E019','全辨悼19','PT0038'); --醚公何 3-2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E020','全辨悼20','PT0038'); --醚公何 3-2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E021','全辨悼21','PT0017'); --醚公何 3-3评
INSERT INTO EMPLOYEE_TBL VALUES('E022','全辨悼22','PT0017'); --醚公何 3-3评
INSERT INTO EMPLOYEE_TBL VALUES('E023','全辨悼23','PT0018'); --积魂何 1-1评
INSERT INTO EMPLOYEE_TBL VALUES('E024','全辨悼24','PT0018'); --积魂何 1-1评
INSERT INTO EMPLOYEE_TBL VALUES('E025','全辨悼25','PT0018'); --积魂何 1-1评
INSERT INTO EMPLOYEE_TBL VALUES('E026','全辨悼26','PT0019'); --积魂何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E027','全辨悼27','PT0019'); --积魂何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E028','全辨悼28','PT0019'); --积魂何 1-2评
INSERT INTO EMPLOYEE_TBL VALUES('E029','全辨悼29','PT0020'); --积魂何 1-3评
INSERT INTO EMPLOYEE_TBL VALUES('E030','全辨悼30','PT0020'); --积魂何 1-3评
INSERT INTO EMPLOYEE_TBL VALUES('E031','全辨悼31','PT0020'); --积魂何 1-3评
INSERT INTO EMPLOYEE_TBL VALUES('E032','全辨悼32','PT0020'); --积魂何 1-3评
INSERT INTO EMPLOYEE_TBL VALUES('E033','全辨悼33','PT0021'); --积魂何 1-4评
INSERT INTO EMPLOYEE_TBL VALUES('E034','全辨悼34','PT0021'); --积魂何 1-4评
INSERT INTO EMPLOYEE_TBL VALUES('E035','全辨悼35','PT0021'); --积魂何 1-4评
INSERT INTO EMPLOYEE_TBL VALUES('E036','全辨悼36','PT0021'); --积魂何 1-4评
INSERT INTO EMPLOYEE_TBL VALUES('E037','全辨悼37','PT0021'); --积魂何 1-4评
INSERT INTO EMPLOYEE_TBL VALUES('E038','全辨悼38','PT0022'); --积魂何 2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E039','全辨悼39','PT0022'); --积魂何 2-1评
INSERT INTO EMPLOYEE_TBL VALUES('E040','全辨悼40','PT0023'); --积魂何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E041','全辨悼41','PT0023'); --积魂何 2-2评
INSERT INTO EMPLOYEE_TBL VALUES('E042','全辨悼42','PT0024'); --积魂何 3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E043','全辨悼43','PT0024'); --积魂何 3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E044','全辨悼44','PT0025'); --积魂何 3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E045','全辨悼45','PT0025'); --积魂何 3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E046','全辨悼46','PT0025'); --积魂何 3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E047','全辨悼47','PT0039'); --积魂何 3-3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E048','全辨悼48','PT0039'); --积魂何 3-3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E049','全辨悼49','PT0039'); --积魂何 3-3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E050','全辨悼50','PT0039'); --积魂何 3-3-1评
INSERT INTO EMPLOYEE_TBL VALUES('E051','全辨悼51','PT0040'); --积魂何 3-3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E052','全辨悼52','PT0040'); --积魂何 3-3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E053','全辨悼53','PT0040'); --积魂何 3-3-2评
INSERT INTO EMPLOYEE_TBL VALUES('E054','全辨悼54','PT0041'); --积魂何 3-3-3评
INSERT INTO EMPLOYEE_TBL VALUES('E055','全辨悼55','PT0041'); --积魂何 3-3-3评

SELECT * FROM EMPLOYEE_TBL;
--COMMIT;

CREATE TABLE PARTS_TBL
(
    PART_ID     CHAR(6)         NOT NULL,
    PART_NAME   VARCHAR2(30)    NOT NULL,
    PART_LVL    NUMBER(4)       NOT NULL,
    PART_SEQ    NUMBER(4)       NOT NULL, -- 沥纺 鉴辑甫 唱鸥郴绰 鉴辑蔼
    PARENT_PART_ID  CHAR(6)     NULL      --何辑, 评狼 何葛酒捞叼(PARTENT ID)
);

--DROP TABLE PARTS_TBL;
INSERT INTO PARTS_TBL VALUES('PT0001','ROOT',0, 1, NULL);


INSERT INTO PARTS_TBL VALUES('PT0002','牢荤何',1, 1, 'PT0001');
INSERT INTO PARTS_TBL VALUES('PT0003','醚公何',1, 2, 'PT0001');
INSERT INTO PARTS_TBL VALUES('PT0004','积魂何',1, 3, 'PT0001');

INSERT INTO PARTS_TBL VALUES('PT0005','醚公何 1评',2, 1, 'PT0003');
INSERT INTO PARTS_TBL VALUES('PT0006','醚公何 2评',2, 2, 'PT0003');
INSERT INTO PARTS_TBL VALUES('PT0007','醚公何 3评',2, 3, 'PT0003');

INSERT INTO PARTS_TBL VALUES('PT0008','积魂何 1评',2, 1, 'PT0004');
INSERT INTO PARTS_TBL VALUES('PT0009','积魂何 2评',2, 2, 'PT0004');
INSERT INTO PARTS_TBL VALUES('PT0010','积魂何 3评',2, 3, 'PT0004');

INSERT INTO PARTS_TBL VALUES('PT0011','醚公何 1-1评',3, 1, 'PT0005');
INSERT INTO PARTS_TBL VALUES('PT0012','醚公何 1-2评',3, 2, 'PT0005');

INSERT INTO PARTS_TBL VALUES('PT0013','醚公何 2-1评',3, 1, 'PT0006');
INSERT INTO PARTS_TBL VALUES('PT0014','醚公何 2-2评',3, 2, 'PT0006');

INSERT INTO PARTS_TBL VALUES('PT0015','醚公何 3-1评',3, 1, 'PT0007');
INSERT INTO PARTS_TBL VALUES('PT0016','醚公何 3-2评',3, 2, 'PT0007');
INSERT INTO PARTS_TBL VALUES('PT0017','醚公何 3-3评',3, 3, 'PT0007');

INSERT INTO PARTS_TBL VALUES('PT0018','积魂何 1-1评',3, 1, 'PT0008');
INSERT INTO PARTS_TBL VALUES('PT0019','积魂何 1-2评',3, 2, 'PT0008');
INSERT INTO PARTS_TBL VALUES('PT0020','积魂何 1-3评',3, 3, 'PT0008');
INSERT INTO PARTS_TBL VALUES('PT0021','积魂何 1-4评',3, 4, 'PT0008');

INSERT INTO PARTS_TBL VALUES('PT0022','积魂何 2-1评',3, 1, 'PT0009');
INSERT INTO PARTS_TBL VALUES('PT0023','积魂何 2-2评',3, 2, 'PT0009');

INSERT INTO PARTS_TBL VALUES('PT0024','积魂何 3-1评',3, 1, 'PT0010');
INSERT INTO PARTS_TBL VALUES('PT0025','积魂何 3-2评',3, 2, 'PT0010');
INSERT INTO PARTS_TBL VALUES('PT0026','积魂何 3-3评',3, 3, 'PT0010');

INSERT INTO PARTS_TBL VALUES('PT0037','醚公何 3-2-1评',4, 1, 'PT0016');
INSERT INTO PARTS_TBL VALUES('PT0038','醚公何 3-2-2评',4, 2, 'PT0016');

INSERT INTO PARTS_TBL VALUES('PT0039','积魂何 3-3-1评',4, 1, 'PT0026');
INSERT INTO PARTS_TBL VALUES('PT0040','积魂何 3-3-2评',4, 2, 'PT0026');
INSERT INTO PARTS_TBL VALUES('PT0041','积魂何 3-3-3评',4, 3, 'PT0026');

SELECT * FROM PARTS_TBL;

--1.拌摸屈 单捞磐俊 措茄 捞秦
--2.拌摸屈 孽府俊 措茄 捞秦 -- 10G 滚傈 捞惑何磐 悼累 老何 俊矾 啊瓷己

    SELECT *
    FROM PARTS_TBL
    START WITH PART_NAME = 'ROOT' --START WITH 盖 怖瘤痢
    CONNECT BY PRIOR PART_ID = PARENT_PART_ID
    ORDER SIBLINGS BY PART_NAME
    ;
    
    SELECT *
    FROM PARTS_TBL
    START WITH PARENT_PART_ID = 'PT0026'
    CONNECT BY PRIOR PARENT_PART_ID = PART_ID
    ;
    
    SELECT *
    FROM PARTS_TBL
    START WITH PART_ID = 'PT0003'
    CONNECT BY PRIOR PART_ID = PARENT_PART_ID
    ;

--3.拌摸屈 单捞磐甫 啊瘤绊 乐绰 抛捞喉苞狼 炼牢

SELECT * 
FROM EMPLOYEE_TBL T1, PARTS_TBL T2
WHERE T1.PART_ID = T2.PART_ID
--START WITH T2.PART_ID = 'PT0001'
--CONNECT BY PRIOR T1.PART_ID = T2.PARENT_PART_ID
;

SELECT * FROM EMPLOYEE_TBL;
SELECT * FROM PARTS_TBL;


SELECT T7.E_NAME, T6.A, T6.B, T6.C
FROM
(
SELECT T4.E_NAME, T1.PART_ID, T1.PART_NAME AS A, T2.PART_NAME AS B, T3.PART_NAME AS C
FROM PARTS_TBL T1, PARTS_TBL T2, PARTS_TBL T3, EMPLOYEE_TBL T4
WHERE T1.PART_ID = T2.PARENT_PART_ID
AND T2.PART_ID = T3.PARENT_PART_ID
AND T3.PART_ID = T4.PART_ID
)T6,
(
SELECT E_NAME, PART_ID
FROM EMPLOYEE_TBL
)T7
WHERE T6.E_NAME(+) = T7.E_NAME
;

--------------------------------------------------------------------------------
SELECT * FROM EMPLOYEE_TBL;
SELECT * FROM PARTS_TBL;

SELECT A.捞抚
FROM
(
    SELECT PART1.PART_NAME AS 捞抚, PART2.PART_NAME, PART3.PART_NAME, PART4.PART_NAME
    FROM
    (
        SELECT * FROM PARTS_TBL
        WHERE PART_LVL = 1
    )PART1,
    (
        SELECT * FROM PARTS_TBL
        WHERE PART_LVL = 2
    )PART2,
    (
        SELECT * FROM PARTS_TBL
        WHERE PART_LVL = 3
    )PART3,
    (
        SELECT * FROM PARTS_TBL
        WHERE PART_LVL = 4
    )PART4
    WHERE PART1.PART_ID = PART2.PARENT_PART_ID(+)
    AND PART2.PART_ID = PART3.PARENT_PART_ID(+)
    AND PART3.PART_ID = PART4.PARENT_PART_ID(+)
)A,
(
SELECT * 
FROM PARTS_TBL
)B
WHERE A.捞抚(+) = B.PART_NAME
;

--------------------------------------------------------------------------------

SELECT * FROM EMPLOYEE_TBL;
SELECT * FROM PARTS_TBL;

SELECT T6.E_NAME, T1.PART_NAME, T2.PART_NAME, T3.PART_NAME, T4.PART_NAME, T5.PART_NAME
FROM PARTS_TBL T1, PARTS_TBL T2, PARTS_TBL T3, PARTS_TBL T4, PARTS_TBL T5, EMPLOYEE_TBL T6
WHERE T1.PARENT_PART_ID = T2.PART_ID(+)
AND T2.PARENT_PART_ID = T3.PART_ID(+)
AND T3.PARENT_PART_ID = T4.PART_ID(+)
AND T4.PARENT_PART_ID = T5.PART_ID(+)
AND T1.PART_ID = T6.PART_ID
ORDER BY T1.PART_ID
;

SELECT T6.E_NAME, T5.PART_NAME, T4.PART_NAME, T3.PART_NAME, T2.PART_NAME, T1.PART_NAME
FROM PARTS_TBL T1, PARTS_TBL T2, PARTS_TBL T3, PARTS_TBL T4, PARTS_TBL T5, EMPLOYEE_TBL T6
WHERE T1.PART_ID(+) = T2.PARENT_PART_ID
AND T2.PART_ID(+) = T3.PARENT_PART_ID
AND T3.PART_ID(+) = T4.PARENT_PART_ID
AND T4.PART_ID(+) = T5.PARENT_PART_ID
AND T5.PART_ID = T6.PART_ID
ORDER BY T5.PART_ID
;

SELECT *
FROM PARTS_TBL T1, PARTS_TBL T2--, PARTS_TBL T3, PARTS_TBL T4, PARTS_TBL T5
WHERE T1.PART_ID = T2.PARENT_PART_ID(+)
--AND T2.PART_ID = T3.PARENT_PART_ID(+)
--AND T3.PART_ID = T4.PARENT_PART_ID(+)
--AND T4.PART_ID = T5.PARENT_PART_ID(+)
ORDER BY T1.PART_ID
;